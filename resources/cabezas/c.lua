cabezas = {
[1] = {modelo = 16041, raza = 4, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[2] = {modelo = 16040, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[3] = {modelo = 16039, raza = 1, cx = -0.002, cy = 0.04, cz = -0.255, rcx = 3, rcy = -90, rcz = 8, scalec = 1},
[4] = {modelo = 16038, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[5] = {modelo = 13864, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[6] = {modelo = 13863, raza = 2, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[7] = {modelo = 13862, raza = 2, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[8] = {modelo = 18448, raza = 2, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[9] = {modelo = 18215, raza = 2, cx = -0.002, cy = -0.006, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[10] = {modelo = 18214, raza = 2, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[11] = {modelo = 18213, raza = 1, cx = -0.002, cy = 0.015, cz = -0.2, rcx = 0, rcy = -90, rcz = 14, scalec = 1.05},
[12] = {modelo = 18212, raza = 1, cx = -0.002, cy = 0.015, cz = -0.18, rcx = 0, rcy = -90, rcz = 13, scalec = 1},
[13] = {modelo = 18211, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[14] = {modelo = 18210, raza = 1, cx = -0.002, cy = 0.015, cz = -0.29, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[15] = {modelo = 18209, raza = 1, cx = -0.002, cy = 0.015, cz = -0.22, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[16] = {modelo = 13861, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[17] = {modelo = 18208, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[18] = {modelo = 18207, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[19] = {modelo = 18206, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[20] = {modelo = 18205, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[21] = {modelo = 18204, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[22] = {modelo = 7649, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[23] = {modelo = 7648, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[24] = {modelo = 7647, raza = 4, cx = -0.002, cy = 0.015, cz = -0.22, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[25] = {modelo = 7646, raza = 4, cx = -0.002, cy = 0.015, cz = -0.22, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[26] = {modelo = 7645, raza = 4,  cx = -0.006, cy = 0.02, cz = -0.200, rcx = 0, rcy = -90, rcz = 15, scalec = 1},
[27] = {modelo = 7644, raza = 1, cx = -0.002, cy = 0.015, cz = -0.230, rcx = 0, rcy = -90, rcz = 8, scalec = 1.02},
[28] = {modelo = 7643, raza = 3, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[29] = {modelo = 7642, raza = 2, cx = -0.002, cy = 0.007, cz = -0.27, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[30] = {modelo = 7640, raza = 4, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[31] = {modelo = 7639, raza = 4, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[32] = {modelo = 7638, raza = 4, cx = -0.002, cy = 0.015, cz = -0.3, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[33] = {modelo = 7637, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[34] = {modelo = 7578, raza = 1, cx = -0.002, cy = 0.015, cz = -0.17, rcx = 0, rcy = -90, rcz = 8, scalec = 1.02},
[35] = {modelo = 16099, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[36] = {modelo = 16050, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[37] = {modelo = 16049, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[38] = {modelo = 16048, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[39] = {modelo = 16047, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[40] = {modelo = 16046, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[41] = {modelo = 16045, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[42] = {modelo = 16044, raza = 1, cx = -0.002, cy = 0.015, cz = -0.28, rcx = 0, rcy = -90, rcz = 12, scalec = 1},
[43] = {modelo = 16043, raza = 1, cx = -0.002, cy = 0.015, cz = -0.16, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[44] = {modelo = 16042, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[45] = {modelo = 7562, raza = 3, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[46] = {modelo = 7563, raza = 3, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[47] = {modelo = 7564, raza = 3, cx = -0.002, cy = 0, cz = -0.15, rcx = 0, rcy = -90, rcz = 10, scalec = 1.02},
[48] = {modelo = 7565, raza = 3, cx = -0.002, cy = 0.015, cz = -0.21, rcx = 0, rcy = -90, rcz = 8, scalec = 1.1},
[49] = {modelo = 7566, raza = 3, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[50] = {modelo = 7566, raza = 3, cx = -0.002, cy = 0.015, cz = -0.2, rcx = 0, rcy = -90, rcz = 15, scalec = 0.92},
[51] = {modelo = 7568, raza = 3, cx = -0.002, cy = 0.03, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[52] = {modelo = 7569, raza = 2, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[53] = {modelo = 7570, raza = 2, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[54] = {modelo = 7571, raza = 2, cx = -0.006, cy = 0.02, cz = -0.27, rcx = 0, rcy = -90, rcz = 15, scalec = 1},
[55] = {modelo = 13870, raza = 4, cx = -0.002, cy = 0.015, cz = -0.15, rcx = 0, rcy = -90, rcz = 8, scalec = 0.9},
[56] = {modelo = 7692, raza = 1, cx = -0.002, cy = 0.015, cz = -0.15, rcx = 0, rcy = -90, rcz = 8, scalec = 0.9},
[57] = {modelo = 7694, raza = 1,cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[58] = {modelo = 7698, raza = 1, cx = -0.002, cy = 0.015, cz = -0.272, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[62] = {modelo = 7704, raza = 1, cx = -0.002, cy = 0.015, cz = -0.275, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[63] = {modelo = 18300, raza = 2, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[65] = {modelo = 7710, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[67] = {modelo = 7712, raza = 1, cx = -0.002, cy = 0.015, cz = -0.255, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[68] = {modelo = 7714, raza = 1, cx = -0.002, cy = 0.019, cz = -0.217, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[69] = {modelo = 18460, raza = 3, cx = -0.002, cy = 0.019, cz = -0.22, rcx = 2, rcy = -90, rcz = 8, scalec = 0.9},
[70] = {modelo = 18462, raza = 3, cx = -0.002, cy = 0.019, cz = -0.2, rcx = 1, rcy = -90, rcz = 8, scalec = 0.9},
[71] = {modelo = 18463, raza = 2, cx = -0.002, cy = 0.015, cz = -0.29, rcx = 2, rcy = -90, rcz = 8, scalec = 1},
[72] = {modelo = 18466, raza = 2, cx = -0.002, cy = 0.015, cz = -0.31, rcx = -1, rcy = -90, rcz = 8, scalec = 1},
[73] = {modelo = 18467, raza = 2, cx = -0.002, cy = 0.015, cz = -0.31, rcx = 1, rcy = -90, rcz = 8, scalec = 1},
[74] = {modelo = 18468, raza = 3, cx = -0.002, cy = 0.015, cz = -0.29, rcx = 2, rcy = -90, rcz = 8, scalec = 1},
[75] = {modelo = 18470, raza = 2, cx = -0.002, cy = 0.015, cz = -0.29, rcx = 2, rcy = -90, rcz = 8, scalec = 1},
[76] = {modelo = 18472, raza = 2, cx = -0.002, cy = 0.015, cz = -0.260, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[77] = {modelo = 18474, raza = 2, cx = -0.002, cy = 0.015, cz = -0.40, rcx = 0, rcy = -90, rcz = 8, scalec = 1.1},
[78] = {modelo = 18475, raza = 2, cx = -0.002, cy = 0.015, cz = -0.320, rcx = -4, rcy = -90, rcz = 8, scalec = 1},
[79] = {modelo = 18476, raza = 3, cx = -0.002, cy = 0.015, cz = -0.3, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[80] = {modelo = 18477, raza = 2, cx = -0.002, cy = 0.015, cz = -0.3, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[81] = {modelo = 18478, raza = 3, cx = -0.002, cy = 0.015, cz = -0.20, rcx = 3, rcy = -90, rcz = 8, scalec = 1},
[82] = {modelo = 18479, raza = 3, cx = -0.002, cy = 0.015, cz = -0.275, rcx = 0, rcy = -90, rcz = 8, scalec = 1},
[83] = {modelo = 18480, raza = 3, cx = -0.002, cy = 0.015, cz = -0.29, rcx = 0, rcy = -90, rcz = 8, scalec = 1},












}

for u, cabeza in pairs ( cabezas ) do
	engineImportTXD ( engineLoadTXD( "modelos/"..u..".txd" ),  cabeza.modelo )
	engineReplaceModel ( engineLoadDFF ( "modelos/"..u..".dff" ), cabeza.modelo)
end

function getCabezasRaza(raza)
	local tablafinal = {}
	for i, cab in pairs ( cabezas ) do
		if cab.raza == raza then
		table.insert(tablafinal, i)
		end
	end
	return tablafinal
end

local cabezasplayers = {}

function ponerCabeza(player, id)
	if isElement(cabezasplayers[player]) then
	destroyElement(cabezasplayers[player])
	end
	if id then
	local px,py,pz = getElementPosition(player)
	local data = cabezas[tonumber(id)]
	modelorem,cx,cy,cz,rx,ry,rz,scale = data.modelo, data.cx, data.cy, data.cz, data.rcx, data.rcy, data.rcz, data.scalec
	
	cabezasplayers[player] = createObject(data.modelo, px, py, pz+1)
	setObjectScale(cabezasplayers[player], data.scalec)
	setElementDimension( cabezasplayers[player], getElementDimension(player))
	setElementCollisionsEnabled(cabezasplayers[player], false)
	exports.bone_attach:attachElementToBone(cabezasplayers[player], player, 2, data.cx,data.cy,data.cz,data.rcx,data.rcy,data.rcz)
	end
end
addEvent("cabeza:poner", true)
addEventHandler("cabeza:poner", localPlayer, ponerCabeza)

texture = dxCreateTexture ( "texturas/transparente.png" )
shader, tec = dxCreateShader( "shader.fx", 1000, 0, false )
engineApplyShaderToWorldTexture ( shader, "sphere" )
engineApplyShaderToWorldTexture ( shader, "bloodpool_64" )
dxSetShaderValue ( shader, "gTexture", texture )

function isPedAiming ( thePedToCheck )
	if isElement(thePedToCheck) then
		if getElementType(thePedToCheck) == "player" or getElementType(thePedToCheck) == "ped" then
			if getPedTask(thePedToCheck, "secondary", 0) == "TASK_SIMPLE_USE_GUN" then
				return true
			end
		end
	end
	return false
end

function updateCamera ()
	local wp = getPedWeapon ( localPlayer )
	if getElementModel(localPlayer) == 0 and getElementData(localPlayer, "isLoged") then
		if isElement(cabezasplayers[localPlayer]) then
			if isPedAiming(localPlayer) then
				if wp == 34 or wp == 43 then
					setElementAlpha(cabezasplayers[localPlayer], 0)
				end
			elseif getElementAlpha(cabezasplayers[localPlayer]) == 0 then
				setElementAlpha(cabezasplayers[localPlayer], 255)
			end
		end
	end
end
addEventHandler ( "onClientRender", root, updateCamera )

function getCabezaPlayer(player)
	return cabezasplayers[player]
end

function getCabezaData(id)
	return cabezas[tonumber(id)]
end




